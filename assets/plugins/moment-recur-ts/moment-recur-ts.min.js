!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("moment")):"function"==typeof define&&define.amd?define("moment-recur-ts",["moment"],t):"object"==typeof exports?exports["moment-recur-ts"]=t(require("moment")):e["moment-recur-ts"]=t(e.moment)}(window,function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(t,r){t.exports=e},function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,r){if(!r)throw new Error("Must have a start date set to set an interval!");this.start=r.clone(),this.measure=t,this.units=this.normalizeUnits(e)}return e.prototype.match=function(e){var t,r,i="days"!==this.measure,o=Math.abs(this.start.diff(e,this.measure,i));try{for(var a=n(this.units),s=a.next();!s.done;s=a.next()){if(o%s.value==0)return!0}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return!1},e.prototype.next=function(e){var t=e.diff(this.start,this.measure),r=this.units.map(function(e){return(Math.floor(t/e)+1)*e});return r.sort(function(e,t){return e-t}),this.start.clone().add(r[0],this.measure)},e.prototype.previous=function(e){var t=this.start.diff(e,this.measure),r=this.units.map(function(e){return(Math.floor(t/e)+1)*e});return r.sort(function(e,t){return t-e}),this.start.clone().subtract(r[0],this.measure)},e.prototype.normalizeUnits=function(e){return e.map(function(e){if((e=+e)<=0)throw new Error("Intervals must be greater than zero.");if(!Number.isInteger(e))throw new Error("Intervals must be integers.");return e}).sort(function(e,t){return e-t})},e}();t.Interval=i},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(0)),o=function(){function e(t,r){this.measure=r,this.units=this.normalizeUnits(t),this.range=e.ranges[this.measure].range,this.period=e.ranges[this.measure].period}return e.prototype.match=function(e){var t=this.periodUnit(e);return-1!==this.units.indexOf(t)||-1===this.units[0]&&t===this.periodUnit(i.default(e).endOf(this.range))},e.prototype.next=function(e,t){var r=e.clone();if(!this.isLastDayOfPeriod(r)){var n=i.default(r).add(1,"day");if(this.match(n))return n}for(;;){var o=this.nextPeriod(r);if(o)return o;if(r=this.incrementRange(r,1),this.match(r))return r;if(r.isSameOrAfter(t))throw new RangeError("Recurrence Year limit exceeded.")}},e.prototype.previous=function(e,t){var r=e.clone();if(!this.isFirstDayOfPeriod(r)){var n=i.default(r).subtract(1,"day");if(this.match(n))return n}for(;;){var o=this.previousPeriod(r);if(o)return o;if(r=this.decrementRange(r,1),this.match(r))return r;if(r.isSameOrBefore(t))throw new RangeError("Recurrence Year limit exceeded.")}},e.prototype.normalizeUnits=function(t){var r=this,n=e.ranges[this.measure].low,o=e.ranges[this.measure].high;return t.map(function(e){if("last"===e&&(e=-1),"number"!=typeof e&&(e="daysOfWeek"===r.measure?i.default().set("days",e).get("days"):"monthsOfYear"===r.measure?i.default().set("months",e).get("months"):+e),!Number.isInteger(e))throw new TypeError("Invalid calendar unit in recurrence: "+e);if((e<n||e>o)&&-1!==e)throw new RangeError("Value should be in range "+n+" to "+o);return e}).sort(function(e,t){return e-t})},e.prototype.periodUnit=function(e,t){switch(this.measure){case"daysOfWeek":return e.day(t);case"daysOfMonth":return e.date(t);case"weeksOfMonth":return e.monthWeek(t);case"weeksOfMonthByDay":return e.monthWeekByDay(t);case"weeksOfYear":return e.week(t);case"monthsOfYear":return e.month(t)}},e.prototype.nextPeriod=function(e){var t=this,r=this.periodUnit(e),n=this.units.map(function(r){return-1===r?t.periodUnit(e.clone().endOf(t.range)):r}).find(function(e){return e>r});return void 0!==n?this.periodUnit(e.clone(),n).startOf(this.period):"weeksOfYear"===this.measure&&-1!==this.units.indexOf(1)?e.clone().endOf("year").startOf("week"):void 0},e.prototype.previousPeriod=function(e){var t=this,r=this.periodUnit(e);"weeksOfYear"===this.measure&&11===e.month()&&1===e.week()&&(r=53);var n=this.units.map(function(r){return-1===r?t.periodUnit(e.clone().endOf(t.range)):r}).reverse().find(function(e){return e<r});return void 0!==n?("weeksOfYear"===this.measure&&53===r&&e.week(0),this.periodUnit(e.clone(),n).endOf(this.period)):"weeksOfYear"===this.measure&&this.units.some(function(e){return 52>=e&&e<=53})?e.clone().startOf("year").endOf("week"):void 0},e.prototype.incrementRange=function(e,t){return e.add(t,this.range).startOf(this.range)},e.prototype.decrementRange=function(e,t){return e.subtract(t,this.range).endOf(this.range)},e.prototype.isLastDayOfPeriod=function(e){return"weeksOfMonthByDay"===this.measure?e.monthWeekByDay()!==i.default(e).add(1,"day").monthWeekByDay():"day"===this.period||e.isSame(i.default(e).endOf(this.period))},e.prototype.isFirstDayOfPeriod=function(e){return"weeksOfMonthByDay"===this.measure?e.monthWeekByDay()!==i.default(e).subtract(1,"day").monthWeekByDay():"day"===this.period||e.isSame(i.default(e).startOf(this.period))},e.ranges={daysOfWeek:{period:"day",range:"week",low:0,high:6},daysOfMonth:{period:"day",range:"month",low:1,high:31},weeksOfMonth:{period:"week",range:"month",low:0,high:4},weeksOfMonthByDay:{period:"week",range:"month",low:0,high:4},weeksOfYear:{period:"week",range:"year",low:1,high:53},monthsOfYear:{period:"month",range:"year",low:0,high:11}},e}();t.Calendar=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(1);!function(e){function t(e){if(null==e)throw new Error("Units not defined for recurrence rule.");if(Array.isArray(e))return e;if("object"==typeof e)return Object.keys(e);if("number"==typeof e)return[e];if("string"==typeof e)return[e];throw new Error("Provide an array, object, string or number when passing units!")}function r(t){if("string"==typeof t){if(e.MeasureSingleToPlural[t])return e.MeasureSingleToPlural[t];for(var r in e.MeasureSingleToPlural)if(e.MeasureSingleToPlural[r]===t)return t}throw new Error("Invalid Measure for recurrence: "+t)}e.MeasureSingleToPlural={day:"days",week:"weeks",month:"months",year:"years",dayOfWeek:"daysOfWeek",dayOfMonth:"daysOfMonth",weekOfMonth:"weeksOfMonth",weekOfMonthByDay:"weeksOfMonthByDay",weekOfYear:"weeksOfYear",monthOfYear:"monthsOfYear"},e.factory=function(e,o,a){var s=r(o);switch(s){case"days":case"weeks":case"months":case"years":return new i.Interval(t(e),s,a);case"daysOfWeek":case"daysOfMonth":case"weeksOfMonth":case"weeksOfMonthByDay":case"weeksOfYear":case"monthsOfYear":return new n.Calendar(t(e),s)}},e.normalizeMeasure=r}(t.Rule||(t.Rule={}))},function(e,t,r){"use strict";var n=this&&this.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(r(0)),s=r(3),u=function(){function e(e){var t=this;this.reversed=!1,this.maximumYears=1e3,e.start&&(this.start=a.default(e.start).dateOnly()),e.end&&(this.end=a.default(e.end).dateOnly()),this.rules=(e.rules||[]).map(function(e){return s.Rule.factory(e.units,e.measure,t.start)});var r=e.exceptions||[];return this.exceptions=r.map(function(e){return a.default(e).dateOnly()}),this.units=null,this.measure=null,this.from=void 0,this.addMeasureFunctions(),this}return e.prototype.startDate=function(e){if(null===e)return this.start=void 0,this;if(e)return this.start=a.default(e).dateOnly(),this;if(!this.start)throw new Error("No start date defined for recurrence.");return this.start},e.prototype.endDate=function(e){if(null===e)return this.end=void 0,this;if(e)return this.end=a.default(e).dateOnly(),this;if(!this.end)throw new Error("No end date defined for recurrence.");return this.end},e.prototype.fromDate=function(e){if(null===e)return this.from=void 0,this;if(e)return this.from=a.default(e).dateOnly(),this;if(!this.from)throw new Error("No from date defined for recurrence.");return this.from},e.prototype.maxYears=function(e){return e?(this.maximumYears=e,this):this.maximumYears},e.prototype.save=function(){var e={};return this.start&&a.default(this.start).isValid()&&(e.start=this.start.format("YYYY-MM-DD")),this.end&&a.default(this.end).isValid()&&(e.end=this.end.format("YYYY-MM-DD")),e.exceptions=this.exceptions.map(function(e){return e.format("YYYY-MM-DD")}),e.rules=this.rules,e},e.prototype.repeats=function(){return this.rules.length>0},e.prototype.every=function(e,t){if(null!=e&&(this.units=e),null!=t&&(this.measure=t),!this.measure)return this;var r=s.Rule.factory(this.units,this.measure,this.start);if("weeksOfMonthByDay"===r.measure&&!this.hasRule("daysOfWeek"))throw new Error("weeksOfMonthByDay must be combined with daysOfWeek");return this.units=null,this.measure=null,this.rules=this.rules.filter(function(e){return e.measure!==r.measure}),this.rules.push(r),this},e.prototype.except=function(e){return e=a.default(e).dateOnly(),this.exceptions.push(e),this},e.prototype.forget=function(e,t){if(!e)throw new Error("Invalid input for recurrence forget: "+e);try{var r=s.Rule.normalizeMeasure(e);return this.rules=this.rules.filter(function(e){return e.measure!==r}),this}catch(r){var n=a.default(e,t);if(n.isValid())return n=n.dateOnly(),this.exceptions=this.exceptions.filter(function(e){return!n.isSame(e)}),this;throw new Error("Invalid input for recurrence forget: "+e)}},e.prototype.hasRule=function(e){return-1!==this.rules.findIndex(function(t){return t.measure===s.Rule.normalizeMeasure(e)})},e.prototype.matches=function(e,t){var r=a.default(e).dateOnly();if(!r.isValid())throw Error("Invalid date supplied to match method: "+e);return!(!t&&!this.inRange(r))&&(!this.isException(r)&&!!this.matchAllRules(r))},e.prototype[Symbol.iterator]=function(){var e,t;return n(this,function(r){switch(r.label){case 0:if(!(e=this.from||this.start)||!e.isValid())throw Error("Cannot get occurrences without start or from date.");if(this.end&&e>this.end)throw Error("Start date cannot be later than end date.");return t=e.clone(),this.matchAllRules(t)?[4,t.clone()]:[3,2];case 1:r.sent(),r.label=2;case 2:try{t=this.reversed?this.findPreviousMatch(t):this.findNextMatch(t)}catch(e){if(e instanceof RangeError)return[2,void 0];throw e}return this.end&&t.isAfter(this.end)?[3,5]:this.isException(t)?[3,4]:[4,t.clone()];case 3:r.sent(),r.label=4;case 4:return[3,2];case 5:return[2]}})},e.prototype.reverse=function(){return this.reversed=!this.reversed,this},e.prototype.all=function(e){var t,r;if(!this.end||!this.end.isValid())throw Error("Cannot get all occurrences without an end date.");this.reversed=!1;var n=[];try{for(var o=i(this),a=o.next();!a.done;a=o.next()){var s=a.value;n.push(e?s.format(e):s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},e.prototype.next=function(e,t){var r,n;if(!e)return[];var o=[],a=0;this.reversed=!1;try{for(var s=i(this),u=s.next();!u.done;u=s.next()){var f=u.value;if(this.start&&f.isSame(this.start)||(o.push(t?f.format(t):f),a++),a>=e)break}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o},e.prototype.previous=function(e,t){var r,n;if(!e)return[];var o=[],a=0;this.reversed=!0;try{for(var s=i(this),u=s.next();!u.done;u=s.next()){var f=u.value;if(this.start&&f.isSame(this.start)||(o.push(t?f.format(t):f),a++),a>=e)break}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o},e.prototype.addMeasureFunctions=function(){var t,r,n=this,o=function(t){var r=s.Rule.MeasureSingleToPlural[t];e.prototype[t]=function(e){return n.every(e,r),n},e.prototype[r]=function(e){return n.every(e,r),n}};try{for(var a=i(Object.keys(s.Rule.MeasureSingleToPlural)),u=a.next();!u.done;u=a.next()){o(u.value)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}},e.prototype.inRange=function(e){return(!this.start||!e.isBefore(this.start))&&(!this.end||!e.isAfter(this.end))},e.prototype.isException=function(e){var t,r;try{for(var n=i(this.exceptions),o=n.next();!o.done;o=n.next()){var s=o.value;if(a.default(s).isSame(e))return!0}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!1},e.prototype.matchAllRules=function(e){var t,r;try{for(var n=i(this.rules),o=n.next();!o.done;o=n.next()){if(!o.value.match(e))return!1}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!0},e.prototype.findNextMatch=function(e){for(var t=e.clone().add(1,"day"),r=e.clone().add(this.maximumYears,"years"),n=!1;!n;){t.subtract(1,"day");var i=this.rules.map(function(e){return e.next(t,r)});i.sort(function(e,t){return e.diff(t)}),n=(t=i[i.length-1]).isSame(i[0])}return t},e.prototype.findPreviousMatch=function(e){for(var t=e.clone().subtract(1,"day"),r=e.clone().subtract(this.maximumYears,"years"),n=!1;!n;){t.add(1,"day");var i=this.rules.map(function(e){return e.previous(t,r)});i.sort(function(e,t){return t.diff(e)}),n=(t=i[i.length-1]).isSame(i[0])}return t},e}();t.Recur=u},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(0)),o=r(4);i.default.fn.monthWeek=function(e){if(void 0===e){var t=this.clone().startOf("month").startOf("week");return this.clone().startOf("week").diff(t,"weeks")}var r=e-this.monthWeek();return this.clone().add(r,"weeks")},i.default.fn.monthWeekByDay=function(e){if(void 0===e)return Math.floor((this.date()-1)/7);var t=e-this.monthWeekByDay();return this.clone().add(t,"weeks")},i.default.fn.dateOnly=function(){return this.isValid()?i.default.utc(this.format("YYYY-MM-DD")):this},i.default.recur=function(e,t){if("object"==typeof e&&!i.default.isMoment(e)){var r=e;return new o.Recur(r)}return new o.Recur({start:e,end:t})},i.default.fn.recur=function(e,t){if(e===Object(e)&&!i.default.isMoment(e)){var r=e;return void 0===r.start&&(r.start=this),new o.Recur(r)}return t||(t=e,e=void 0),e||(e=this),new o.Recur({start:e,end:t})}}])});
//# sourceMappingURL=moment-recur-ts.min.js.map